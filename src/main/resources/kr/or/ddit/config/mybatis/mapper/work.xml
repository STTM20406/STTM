<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="work">

<!-- ******************work**************** -->
	<update id="updateWork" parameterType="workVo">
		UPDATE	WORK
		SET		WRK_LST_ID = #{wrk_lst_id}
				,WRK_PR_ID = #{wrk_pr_id}
				,USER_EMAIL = #{user_email}
				,WRK_NM = #{wrk_nm}
				,WRK_GRADE = #{wrk_grade}
				,WRK_COLOR_CD = #{wrk_color_cd}
				,WRK_START_DT = #{wrk_start_dt}
				,WRK_END_DT = #{wrk_end_dt}
				,WRK_CMP_DT = #{wrk_cmp_dt, jdbcType=DATE}
				,WRK_CMP_FL = #{wrk_cmp_fl}
				,WRK_DEL_FL = #{wrk_del_fl}
		WHERE	WRK_ID = #{wrk_id}
	</update>
	
	<!-- 업무리스트에 해당하는 업무 조회-->
	<select id="getWork" parameterType="int" resultType="workVo">
		SELECT  DISTINCT    C.PRJ_ID
						,  D.PRJ_NM
						,  A.WRK_LST_ID  
					        ,  C.WRK_LST_NM 
					        ,  A.WRK_ID
					        ,  A.WRK_NM
					        ,  C.DEL_FL
					        ,  A.USER_EMAIL
					        ,  B.USER_NM
					        ,  A.WRK_RV_ID
					        ,  A.WRK_PR_ID
					        ,  A.WRK_DT
					        ,  A.WRK_GRADE
					        ,  A.WRK_COLOR_CD
					        ,  A.WRK_START_DT
					        ,  A.WRK_END_DT
					        ,  A.WRK_CMP_DT
					        ,  A.WRK_CMP_FL
					        ,  A.WRK_DEL_FL
   		FROM    			WORK A, USERS B, WORK_LIST C, PROJECT D
      		WHERE			A.WRK_LST_ID = #{wrk_lst_id}
     		AND				A.USER_EMAIL = B.USER_EMAIL
      		AND				A.WRK_LST_ID = C.WRK_LST_ID
      		AND				C.PRJ_ID = D.PRJ_ID
      		AND     			C.DEL_FL = 'N'
	</select>






<!-- ******************work_al_mem**************** -->







<!-- ******************work_comment**************** -->
	<!-- 업무코멘트 등록 -->
	<insert id="commInsert" parameterType="work_commentVo">
		insert into work_comment values(wrk_comm_seq.nextval,#{prj_id},#{user_email},#{wrk_id},#{comm_content},sysdate,'N')
	</insert>
	
	<!-- 업무코멘트 삭제 -->
	<update id="commDelete" parameterType="work_commentVo">
		update work_comment 
		set del_fl='Y' 
		where comm_id=#{comm_id} 
		and prj_id =#{prj_id} 
	</update>
	
	<!-- 업무코멘트 수정 -->
	<update id="commUpdate" parameterType="work_commentVo">
		update work_comment 
		set comm_content=#{comm_content}
		where comm_id=#{comm_id} 
		and prj_id =#{prj_id} 
	</update>
	
	<!-- 업무코멘트 조회 -->
	<select id="commList" parameterType="work_commentVo" resultType="work_commentVo">
		select * 
		from work_comment 
		where wrk_id = #{wrk_id}
		and prj_id = #{prj_id}
	</select>

<!-- ******************work_list**************** -->
	
	<!-- 프로젝트 아이디로  업무 리스트만 조회 -->
	<select id="workList" parameterType="int" resultType="workVo">
		SELECT 	  A.WRK_LST_ID
		     		, A.PRJ_ID
		     		, A.WRK_LST_NM
		     		, A.WRK_LST_DT
		     		, A.DEL_FL 
		FROM   	  WORK_LIST A 
		WHERE  	  PRJ_ID = #{prj_id}
		AND    	  DEL_FL = 'N'
	</select>
	
	<!--  업무리스트 생성 -->
	<insert id="insertWorkList" parameterType="work_listVo">
		INSERT INTO WORK_LIST VALUES(WRK_LST_SEQ.NEXTVAL, #{prj_id}, #{wrk_lst_nm}, SYSDATE, 'N')
	</insert>
	
	<!--  업무리스트 이름 수정 -->
	<update id="updateWorkList" parameterType="int">
		UPDATE WORK_LIST SET WRK_LST_NM = #{wrk_lst_nm} WHERE WRK_LST_ID = #{wrk_lst_id}
	</update>
	
	<!--  업무리스트 삭제 (플래그 업데이트) -->
	<update id="deleteWorkList" parameterType="int">
		UPDATE WORK_LIST SET DEL_FL = 'Y' WHERE WRK_LST_ID = #{wrk_lst_id}
	</update>
	





<!-- ******************work_mem_flw**************** -->






<!-- ******************work_push**************** -->




</mapper>